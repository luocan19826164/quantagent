# ä»£ç  Agent æç¤ºè¯é…ç½®

system_prompt: |
  ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ Python é‡åŒ–ç¼–ç¨‹åŠ©æ‰‹ã€‚ä½ çš„ä»»åŠ¡æ˜¯å¸®åŠ©ç”¨æˆ·ç¼–å†™ã€ä¿®æ”¹å’Œè°ƒè¯•é‡åŒ–äº¤æ˜“ç›¸å…³çš„ä»£ç ã€‚

  ## ä½ çš„èƒ½åŠ›
  1. **ä»£ç ç”Ÿæˆ**: æ ¹æ®ç”¨æˆ·éœ€æ±‚ç”Ÿæˆ Python ä»£ç 
  2. **ä»£ç ä¿®æ”¹**: ä¿®æ”¹ç°æœ‰ä»£ç ï¼Œæ·»åŠ åŠŸèƒ½æˆ–ä¿®å¤bug
  3. **ä»£ç è§£é‡Š**: è§£é‡Šä»£ç çš„åŠŸèƒ½å’Œé€»è¾‘
  4. **è°ƒè¯•å¸®åŠ©**: åˆ†æé”™è¯¯ä¿¡æ¯ï¼Œæä¾›è§£å†³æ–¹æ¡ˆ

  ## è¾“å‡ºæ ¼å¼
  å½“ä½ éœ€è¦åˆ›å»ºæˆ–ä¿®æ”¹æ–‡ä»¶æ—¶ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹æ ¼å¼ï¼š

  ```python:æ–‡ä»¶è·¯å¾„
  ä»£ç å†…å®¹
  ```

  ä¾‹å¦‚ï¼š
  ```python:strategy/rsi.py
  import pandas as pd

  def calculate_rsi(prices, period=14):
      # RSI è®¡ç®—é€»è¾‘
      pass
  ```

  ## ä»£ç è§„èŒƒ
  1. ä½¿ç”¨ type hints æé«˜ä»£ç å¯è¯»æ€§
  2. å‡½æ•°å’Œç±»éœ€è¦æœ‰ docstring
  3. é€‚å½“çš„æ³¨é‡Šè¯´æ˜å¤æ‚é€»è¾‘
  4. éµå¾ª PEP8 ä»£ç é£æ ¼
  5. ä¼˜å…ˆä½¿ç”¨ pandas/numpy å‘é‡åŒ–æ“ä½œæå‡æ€§èƒ½

  ## é‡åŒ–ç¼–ç¨‹å»ºè®®
  1. æ•°æ®å¤„ç†ä½¿ç”¨ pandas DataFrame
  2. æŠ€æœ¯æŒ‡æ ‡è®¡ç®—ä¼˜å…ˆä½¿ç”¨å‘é‡åŒ–æ“ä½œ
  3. å›æµ‹é€»è¾‘è¦è€ƒè™‘æ»‘ç‚¹ã€æ‰‹ç»­è´¹
  4. ä¿¡å·ç”Ÿæˆè¦æ¸…æ™°æ˜ç¡®
  5. é£é™©æ§åˆ¶è¦æœ‰æ­¢æŸæ­¢ç›ˆé€»è¾‘

  ## å®‰å…¨æ³¨æ„äº‹é¡¹
  1. ä¸è¦ç”Ÿæˆå¯èƒ½é€ æˆå®‰å…¨é£é™©çš„ä»£ç 
  2. ä¸è¦è®¿é—®ç”¨æˆ·å·¥ä½œåŒºä»¥å¤–çš„æ–‡ä»¶
  3. ç½‘ç»œè¯·æ±‚åªç”¨äºè·å–è¡Œæƒ…æ•°æ®

greeting: |
  ğŸ‘‹ ä½ å¥½ï¼æˆ‘æ˜¯é‡åŒ–ä»£ç åŠ©æ‰‹ã€‚

  æˆ‘å¯ä»¥å¸®ä½ ï¼š
  - ğŸ“ ç¼–å†™é‡åŒ–ç­–ç•¥ä»£ç 
  - ğŸ”§ ä¿®æ”¹å’Œä¼˜åŒ–ç°æœ‰ä»£ç 
  - ğŸ› è°ƒè¯•å’Œè§£å†³é—®é¢˜
  - ğŸ“Š åˆ†æå’Œè§£é‡Šä»£ç 

  è¯·æè¿°ä½ æƒ³è¦å®ç°çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼š
  - "å¸®æˆ‘å†™ä¸€ä¸ª RSI ç­–ç•¥"
  - "ä¿®æ”¹ main.pyï¼Œæ·»åŠ ç§»åŠ¨å¹³å‡çº¿è®¡ç®—"
  - "è§£é‡Šè¿™æ®µä»£ç çš„ä½œç”¨"

code_templates:
  rsi_strategy: |
    """
    RSI ç­–ç•¥æ¨¡æ¿
    """
    import pandas as pd
    import numpy as np
    from typing import Tuple


    def calculate_rsi(prices: pd.Series, period: int = 14) -> pd.Series:
        """
        è®¡ç®— RSI æŒ‡æ ‡
        
        Args:
            prices: ä»·æ ¼åºåˆ—
            period: RSI å‘¨æœŸï¼Œé»˜è®¤14
            
        Returns:
            RSI å€¼åºåˆ—
        """
        delta = prices.diff()
        gain = (delta.where(delta > 0, 0)).rolling(window=period).mean()
        loss = (-delta.where(delta < 0, 0)).rolling(window=period).mean()
        
        rs = gain / loss
        rsi = 100 - (100 / (1 + rs))
        return rsi


    def generate_signals(prices: pd.Series, 
                         oversold: float = 30, 
                         overbought: float = 70) -> pd.Series:
        """
        ç”Ÿæˆäº¤æ˜“ä¿¡å·
        
        Args:
            prices: ä»·æ ¼åºåˆ—
            oversold: è¶…å–é˜ˆå€¼
            overbought: è¶…ä¹°é˜ˆå€¼
            
        Returns:
            ä¿¡å·åºåˆ—: 1=ä¹°å…¥, -1=å–å‡º, 0=æŒæœ‰
        """
        rsi = calculate_rsi(prices)
        
        signals = pd.Series(0, index=prices.index)
        signals[rsi < oversold] = 1   # ä¹°å…¥ä¿¡å·
        signals[rsi > overbought] = -1  # å–å‡ºä¿¡å·
        
        return signals


    if __name__ == "__main__":
        # ç¤ºä¾‹ç”¨æ³•
        import numpy as np
        
        # ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®
        np.random.seed(42)
        prices = pd.Series(100 + np.cumsum(np.random.randn(100)))
        
        # è®¡ç®— RSI
        rsi = calculate_rsi(prices)
        print(f"æœ€æ–° RSI: {rsi.iloc[-1]:.2f}")
        
        # ç”Ÿæˆä¿¡å·
        signals = generate_signals(prices)
        print(f"æœ€æ–°ä¿¡å·: {signals.iloc[-1]}")

  ma_crossover: |
    """
    å‡çº¿äº¤å‰ç­–ç•¥æ¨¡æ¿
    """
    import pandas as pd
    import numpy as np
    from typing import Tuple


    def calculate_ma(prices: pd.Series, period: int) -> pd.Series:
        """è®¡ç®—ç§»åŠ¨å¹³å‡çº¿"""
        return prices.rolling(window=period).mean()


    def ma_crossover_signals(prices: pd.Series,
                             fast_period: int = 10,
                             slow_period: int = 30) -> pd.Series:
        """
        å‡çº¿äº¤å‰ä¿¡å·
        
        Args:
            prices: ä»·æ ¼åºåˆ—
            fast_period: å¿«çº¿å‘¨æœŸ
            slow_period: æ…¢çº¿å‘¨æœŸ
            
        Returns:
            ä¿¡å·åºåˆ—: 1=é‡‘å‰ä¹°å…¥, -1=æ­»å‰å–å‡º, 0=æŒæœ‰
        """
        fast_ma = calculate_ma(prices, fast_period)
        slow_ma = calculate_ma(prices, slow_period)
        
        signals = pd.Series(0, index=prices.index)
        
        # é‡‘å‰ï¼šå¿«çº¿ä¸Šç©¿æ…¢çº¿
        golden_cross = (fast_ma > slow_ma) & (fast_ma.shift(1) <= slow_ma.shift(1))
        # æ­»å‰ï¼šå¿«çº¿ä¸‹ç©¿æ…¢çº¿
        death_cross = (fast_ma < slow_ma) & (fast_ma.shift(1) >= slow_ma.shift(1))
        
        signals[golden_cross] = 1
        signals[death_cross] = -1
        
        return signals


    if __name__ == "__main__":
        # ç¤ºä¾‹ç”¨æ³•
        np.random.seed(42)
        prices = pd.Series(100 + np.cumsum(np.random.randn(100)))
        
        signals = ma_crossover_signals(prices)
        buy_count = (signals == 1).sum()
        sell_count = (signals == -1).sum()
        
        print(f"ä¹°å…¥ä¿¡å·æ•°: {buy_count}")
        print(f"å–å‡ºä¿¡å·æ•°: {sell_count}")

