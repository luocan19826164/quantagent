# .env 文件配置说明

## 环境变量命名约定

执行 Agent 使用统一的命名约定读取 LLM 配置：

```
{PROVIDER}_API_KEY   - API 密钥（必填）
{PROVIDER}_BASE_URL  - API 地址（必填）
{PROVIDER}_MODEL     - 模型名称（必填）
```

## LLM Provider 优先级

```
1. OPENROUTER  ← 最高优先级（推荐中国用户访问 Claude）
2. DEEPSEEK
3. OPENAI      ← 最低优先级
```

**只需配置你想用的 provider，系统会自动选择第一个完整配置的。**

---

## 配置示例

### 方式 1：使用 OpenRouter（访问 Claude）

```bash
# OpenRouter 配置
OPENROUTER_API_KEY=sk-or-v1-xxxxx
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
OPENROUTER_MODEL=anthropic/claude-sonnet-4

# 可选：用于 OpenRouter 统计
OPENROUTER_SITE_URL=http://localhost:8081
OPENROUTER_APP_NAME=QuantAgent
```

**可用模型**：
- `anthropic/claude-sonnet-4` - Claude Sonnet 4（推荐）
- `anthropic/claude-3.5-sonnet` - Claude 3.5 Sonnet
- `anthropic/claude-3-opus` - Claude 3 Opus（最强，较贵）

**获取 API Key**：https://openrouter.ai/keys

---

### 方式 2：使用 DeepSeek

```bash
# DeepSeek 配置
DEEPSEEK_API_KEY=sk-xxxxx
DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
DEEPSEEK_MODEL=deepseek-reasoner
```

**可用模型**：
- `deepseek-reasoner` - 推理模型（推荐）
- `deepseek-chat` - 对话模型

---

### 方式 3：使用 OpenAI

```bash
# OpenAI 配置
OPENAI_API_KEY=sk-proj-xxxxx
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_MODEL=gpt-4o
```

**可用模型**：
- `gpt-4o` - GPT-4o（推荐）
- `gpt-4o-mini` - GPT-4o Mini（便宜）
- `gpt-4-turbo` - GPT-4 Turbo

---

## 其他配置

### Flask 配置
```bash
SECRET_KEY=quant-agent-secret-key-2024
```

---

## 完整 .env 示例（使用 OpenRouter）

```bash
# ===========================================
# LLM 配置（三选一，按优先级自动选择）
# ===========================================

# 方式1: OpenRouter（推荐中国用户）
OPENROUTER_API_KEY=sk-or-v1-xxxxx
OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
OPENROUTER_MODEL=anthropic/claude-sonnet-4

# 方式2: DeepSeek
# DEEPSEEK_API_KEY=sk-xxxxx
# DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
# DEEPSEEK_MODEL=deepseek-reasoner

# 方式3: OpenAI
# OPENAI_API_KEY=sk-proj-xxxxx
# OPENAI_BASE_URL=https://api.openai.com/v1
# OPENAI_MODEL=gpt-4o

# ===========================================
# Flask 配置
# ===========================================
SECRET_KEY=quant-agent-secret-key-2024
```

---

## 验证配置

启动服务后，查看日志确认使用的 provider：

```bash
python backend/app.py
```

正确配置后会看到：
```
Using OPENROUTER - Model: anthropic/claude-sonnet-4, Base URL: https://openrouter.ai/api/v1
```

---

## 注意事项

1. **必填项**：每个 provider 的 `API_KEY`、`BASE_URL`、`MODEL` 都必须配置
2. **优先级**：如果配置了多个 provider，会按 OPENROUTER > DEEPSEEK > OPENAI 顺序选择
3. **安全**：不要将 `.env` 文件提交到 Git 仓库
4. **重启**：修改 `.env` 后需要重启服务才能生效
